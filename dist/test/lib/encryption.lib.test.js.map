{"version":3,"sources":["../../../test/lib/encryption.lib.test.js"],"names":["RandExp","require","Encryption","crypto","should","generateRandomString","gen","describe","it","done","randomString","key","createHash","update","digest","encrypted","encryptAES","Buffer","from","toString","test","be","true","err","exist"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,aAAaD,QAAQ,0BAAR,CAAnB;AACA,IAAME,SAASF,QAAQ,QAAR,CAAf;AACA,IAAMG,SAASH,QAAQ,QAAR,CAAf;;AAEA,SAASI,oBAAT,GAAgC;AAC5B,WAAO,IAAIL,OAAJ,CAAY,oBAAZ,EAAkCM,GAAlC,EAAP;AACH;;AAEDC,SAAS,2BAAT,EAAsC,YAAM;AACxCC,OAAG,yEAAH,EAA8E,UAACC,IAAD,EAAU;AACpF,YAAMC,eAAeL,sBAArB;AACA,YAAMM,MAAMR,OAAOS,UAAP,CAAkB,QAAlB,EAA4BC,MAA5B,CAAmCH,YAAnC,EAAiDI,MAAjD,EAAZ;AACA,YAAMC,YAAYb,WAAWc,UAAX,CAAsBL,GAAtB,EAA0BM,OAAOC,IAAP,CAAYR,YAAZ,EAA0B,OAA1B,EAAmCS,QAAnC,CAA4C,KAA5C,CAA1B,CAAlB;AACC,wBAAD,CAAmBC,IAAnB,CAAwBL,SAAxB,EAAmCX,MAAnC,CAA0CiB,EAA1C,CAA6CC,IAA7C;AACAb;AACH,KAND;;AAQAD,OAAG,sFAAH,EAA2F,UAACC,IAAD,EAAU;AACjG,YAAMC,eAAeL,sBAArB;AACA,YAAMM,MAAMR,OAAOS,UAAP,CAAkB,QAAlB,EAA4BC,MAA5B,CAAmCH,YAAnC,EAAiDI,MAAjD,EAAZ;AACA,YAAG;AACCZ,uBAAWc,UAAX,CAAsBL,GAAtB,EAA0BM,OAAOC,IAAP,CAAYR,YAAZ,EAA0B,OAA1B,EAAmCS,QAAnC,CAA4C,KAA5C,CAA1B;AACH,SAFD,CAGA,OAAMI,GAAN,EAAU;AACNnB,mBAAOoB,KAAP,CAAaD,GAAb;AACH;;AAEDd;AACH,KAXD;AAYH,CArBD","file":"encryption.lib.test.js","sourcesContent":["const RandExp = require('randexp');\nconst Encryption = require('../../lib/encryption.lib');\nconst crypto = require('crypto');\nconst should = require('should');\n\nfunction generateRandomString() {\n    return new RandExp(/[a-zA-Z0-9]{10,20}/).gen();\n}\n\ndescribe('aes encryption test suite', () => {\n    it('should encrypt a string properly and should output a hex encoded string', (done) => {\n        const randomString = generateRandomString();\n        const key = crypto.createHash('sha256').update(randomString).digest();\n        const encrypted = Encryption.encryptAES(key,Buffer.from(randomString, 'ascii').toString('hex'));\n        (/^[a-fA-F0-9]+$/).test(encrypted).should.be.true();\n        done();\n    });\n\n    it('should throw an error when a key with an incorrect length is provided for encryption', (done) => {\n        const randomString = generateRandomString();\n        const key = crypto.createHash('sha512').update(randomString).digest();\n        try{\n            Encryption.encryptAES(key,Buffer.from(randomString, 'ascii').toString('hex'));\n        }\n        catch(err){\n            should.exist(err);\n        }\n\n        done();\n    })\n});\n"]}